name: LEGION Swarm Deployment (Heavy Compute)

on:
  workflow_dispatch:
    inputs:
      node_count:
        description: 'Number of Nodes'
        default: '5'

jobs:
  ignite_node:
    runs-on: ubuntu-latest
    timeout-minutes: 360
    strategy:
      fail-fast: false
      matrix:
        index: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]
    
    steps:
      - name: Clone Repository
        uses: actions/checkout@v3

      - name: Setup Python Environment
        uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Install Heavy Dependencies
        run: |
          echo "⚡ Installing Deep Learning Core..."
          pip install torch --index-url https://download.pytorch.org/whl/cpu
          pip install petals
          pip install transformers

      - name: Activate Neural Link
        run: |
          echo "⚡ Starting Distributed Inference..."
          python legion_node.py

